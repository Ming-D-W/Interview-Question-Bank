---
title: JavaScript浏览器篇
---

## 七、浏览器篇

本篇介绍浏览器相关的知识点，包括存储机制、跨域解决方案等。

### Cookie、LocalStorage、SessionStorage

**对比表格：**

| 特性 | Cookie | LocalStorage | SessionStorage |
|------|--------|--------------|----------------|
| 存储大小 | 4KB左右 | 5MB左右 | 5MB左右 |
| 生命周期 | 可设置过期时间 | 永久，除非手动清除 | 页面会话期间 |
| 与服务器通信 | 每次HTTP请求都会携带 | 不参与服务器通信 | 不参与服务器通信 |
| 作用域 | 同源且符合path规则 | 同源 | 同源且同窗口 |
| 易用性 | 需要自己封装 | 使用简单 | 使用简单 |

**Cookie详解：**

```js
// 设置cookie
document.cookie = 'name=张三'
document.cookie = 'age=18; expires=Thu, 18 Dec 2025 12:00:00 GMT; path=/'

// 读取cookie
console.log(document.cookie) // 'name=张三; age=18'

// 删除cookie（设置过期时间为过去）
document.cookie = 'name=; expires=Thu, 01 Jan 1970 00:00:00 GMT'

// Cookie属性
// - expires: 过期时间
// - max-age: 有效期（秒）
// - path: 路径
// - domain: 域名
// - secure: 只在HTTPS传输
// - httpOnly: 禁止JavaScript访问（服务端设置）
// - sameSite: 限制第三方Cookie
```

**LocalStorage详解：**

```js
// 存储数据
localStorage.setItem('name', '张三')
localStorage.setItem('age', 18)

// 读取数据
localStorage.getItem('name') // '张三'

// 删除数据
localStorage.removeItem('name')

// 清空所有数据
localStorage.clear()

// 获取键名
localStorage.key(0) // 获取第一个键名

// 获取数量
localStorage.length

// 存储对象（需要转换）
const user = { name: '张三', age: 18 }
localStorage.setItem('user', JSON.stringify(user))
const savedUser = JSON.parse(localStorage.getItem('user'))
```

**SessionStorage详解：**

```js
// API与localStorage完全相同
sessionStorage.setItem('name', '张三')
sessionStorage.getItem('name')
sessionStorage.removeItem('name')
sessionStorage.clear()

// 区别：关闭标签页或浏览器后数据会被清除
```

**监听存储变化：**

```js
// 监听storage事件（只能监听其他页面的修改）
window.addEventListener('storage', (e) => {
  console.log('键名:', e.key)
  console.log('旧值:', e.oldValue)
  console.log('新值:', e.newValue)
  console.log('URL:', e.url)
})
```

**使用场景：**

- **Cookie**: 用户身份验证、会话管理、跟踪用户行为
- **LocalStorage**: 持久化存储、用户偏好设置、购物车（不需要登录）
- **SessionStorage**: 表单数据暂存、单页面数据传递

**安全建议：**

1. 不要存储敏感信息（密码、信用卡号等）
2. 对存储的数据进行加密
3. 设置HttpOnly防止XSS攻击
4. 使用Secure属性确保HTTPS传输
5. 定期清理过期数据
